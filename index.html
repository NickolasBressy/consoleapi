<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Aplicativos</title>
</head>
<body>
    <h1>Gerenciador de Aplicativos Rejeitados</h1>
    <button id="fetchRejectedApps">Buscar Rejeitados</button>
    <div id="rejectedApps"></div>

    <script>
        const proxyUrl = 'https://cors-anywhere.herokuapp.com/'; // Proxy CORS

        document.getElementById('fetchRejectedApps').addEventListener('click', function() {
            fetch(proxyUrl + 'https://script.google.com/macros/s/AKfycbwQUyPz4plmOG7nQAvvNKibiHfiKl3Q83UIWC7gPmVXO1VgbzBiMLEGHR8I4AyVeJLl/exec')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('rejectedApps');
                    container.innerHTML = '';
                    data.forEach((app, index) => {
                        const div = document.createElement('div');
                        div.innerHTML = `
                            <p>App ID: ${app.app_id}</p>
                            <p>Nome: ${app.app_name}</p>
                            <p>Descrição: ${app.app_description}</p>
                            <button onclick="approveApp(${index})">Aprovar</button>
                            <hr>
                        `;
                        container.appendChild(div);
                    });
                })
                .catch(error => console.error('Erro ao buscar rejeitados:', error));
        });

        function approveApp(index) {
            const approvedApp = { app_id: index, status_app: 'Approved' };
            
            fetch(proxyUrl + 'https://script.google.com/macros/s/AKfycbwQUyPz4plmOG7nQAvvNKibiHfiKl3Q83UIWC7gPmVXO1VgbzBiMLEGHR8I4AyVeJLl/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(approvedApp)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Status atualizado:', data);
                alert('Aplicativo aprovado!');
                // Atualize a lista após a aprovação
                document.getElementById('fetchRejectedApps').click();
            })
            .catch(error => console.error('Erro ao atualizar status:', error));
        }
    </script>
</body>
</html>
